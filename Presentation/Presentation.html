<!DOCTYPE html>
<html lang="en"><head>
<script src="Presentation_files/libs/clipboard/clipboard.min.js"></script>
<script src="Presentation_files/libs/quarto-html/tabby.min.js"></script>
<script src="Presentation_files/libs/quarto-html/popper.min.js"></script>
<script src="Presentation_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Presentation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Presentation_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Presentation_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Presentation_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.433">

  <meta name="author" content="Etienne Caprioli">
  <meta name="dcterms.date" content="2024-06-11">
  <title>Changepoint detection</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Presentation_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Presentation_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="Presentation_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="custom.css">
  <link href="Presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Presentation_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Presentation_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Changepoint detection</h1>
  <p class="subtitle">Inference and applications</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Etienne Caprioli 
</div>
<div class="quarto-title-author-email">
<a href="mailto:etienne.caprioli23@imperial.ac.uk">etienne.caprioli23@imperial.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            Imperial College London
          </p>
    </div>
</div>

  <p class="date">June 11, 2024</p>
</section>
<section class="slide level2">

<!--
before rendering execute in the terminal:
- quarto install extension grantmcdermott/quarto-revealjs-clean
- quarto add gadenbuie/revealjs-text-resizer
-->
</section>
<section id="outline-of-this-presentation" class="slide level2">
<h2>Outline of this presentation</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="inference">Inference</h3>
<ul>
<li>Problem setting
<ul>
<li>Statistical test</li>
<li>Online/Offline inference</li>
</ul></li>
<li>What are we interested in ?
<ul>
<li>Single changepoint</li>
<li>Multiple changepoints</li>
</ul></li>
<li>Bayesian approach</li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="applications">Applications</h3>
<ul>
<li>Application in market risk monitoring</li>
<li>Other areas of applications</li>
<li>Useful libraries, packages and repositories</li>
</ul>
</div>
</div>
</section>
<section>
<section id="inference-1" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>Inference</h1>

</section>
<section id="problem-setting" class="slide level2">
<h2>Problem setting</h2>
<h3 id="piecewise-homogeneous-sequences">Piecewise homogeneous sequences</h3>
<p>Let <span class="math inline">\((X_i)_i\)</span> be a sequence of random variables. We model this signal with the equation</p>
<p><span class="math display">\[
X_t = \sum_{j=0}^q X_t^{(j)} ~1_{\tau_j \le t\le \tau_{j+1}}
\]</span> Where each <span class="math inline">\((X_t^{(j)})_j\)</span> can be modeled individually. We are interested in inferring the <em>changepoints</em> <span class="math inline">\((\tau_j)_j\)</span> and the <span class="math inline">\(j\)</span> <em>joint distributions</em> of <span class="math inline">\((X_t^{(j)})_j\)</span>.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>The collections <span class="math inline">\((X_t^{(j)})_j\)</span> can be modeled in very different ways: IID sequences, (non-) stationary time series, IID + trend/seasonality…</p>
</div>
</div>
</div>
</section>
<section id="problem-setting-1" class="slide level2">
<h2>Problem setting</h2>
<h3 id="example-of-datasets">Example of datasets</h3>
<div class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<p><img data-src="Presentation_files/figure-revealjs/cell-2-output-1.png" width="1103" height="542"></p>
</div>
</div>
</section>
<section id="problem-setting-2" class="slide level2">
<h2>Problem setting</h2>
<h3 id="statistical-test">Statistical test</h3>
<p>We will adopt here the most used framework of change in mean, and assume that the variance <span class="math inline">\(\sigma^2\)</span> is known (or estimated).</p>
<p>Let <span class="math inline">\(q\)</span> be the assumed number of changepoints in the dataset, we are interested in testing:</p>
<p><span class="math display">\[\begin{align}
H_0: q = 0 \\
H_1: q = m
\end{align}\]</span></p>
<p>To perform this test, we need a <em>test statistic</em> to be compared to a certain <em>threshold</em>. We will focus here on the likelihood ratio (LR) statistic evaluated at some time point <span class="math inline">\(\tau\)</span>:</p>
<p><span class="math display">\[
LR_\tau = \frac{1}{\sigma^2}\left[ \sum_{i=1}^n (X_i-\bar X_{1:n})^2 - \sum_{i=1}^n (X_i- \bar X_{1:\tau})^2 - \sum_{i=\tau + 1}^n (X_i- \bar X_{\tau +1:n})^2\right]
\]</span> Where <span class="math inline">\(\bar X_{s:t} = \frac{1}{t-s+1}\sum_{i=s}^tX_i\)</span> is the sample mean operator.</p>
</section>
<section id="problem-setting-3" class="slide level2">
<h2>Problem setting</h2>
<h3 id="statistical-test-1">Statistical test</h3>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>CUSUM statistic</strong></p>
</div>
<div class="callout-content">
<p>If we define <span class="math inline">\(C_\tau\)</span> such that</p>
<p><span class="math display">\[
C_\tau = \sqrt{\frac{\tau(n-\tau)}{n}}\left| \bar X_{1:\tau} - \bar X_{\tau + 1:n} \right|
\]</span> We note that <span class="math inline">\(LR_\tau = \frac{C_\tau^2}{\sigma^2}\)</span></p>
</div>
</div>
</div>
</section>
<section id="problem-setting-4" class="slide level2">
<h2>Problem setting</h2>
<h3 id="onlineoffline-inference">Online/Offline inference</h3>
<h4 id="online-inference">Online inference</h4>
<p>The dataset keeps growing through time. We have a continous flow of of datapoints coming. The goal is still to estimate the localisation of the changepoint, but usually the quantity of data <em>after</em> the changepoint is limited. The data is analysed by flow.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example</strong></p>
</div>
<div class="callout-content">
<p>Seismographs continuously monitors the seismic activity in a given zone, stock market quotes are continuously updated.</p>
</div>
</div>
</div>
<h4 id="offline-inference">Offline inference</h4>
<p>The size of the dataset is fixed, the aim is still to detect the changepoints, but this time we have access to possibly much more data after the changepoint.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example</strong></p>
</div>
<div class="callout-content">
<p>Retrospective analysis of economic policies, or natural catastrophes…</p>
</div>
</div>
</div>
</section>
<section id="what-are-we-interested-in" class="slide level2">
<h2>What are we interested in ?</h2>
<h3 id="single-changepoint">Single changepoint</h3>
<p>In some settings we know that there is at most one changepoint in the dataset. In this setting, the inference of the changepoint is well documented and an essentially complete theory exist.</p>
<p>We use the <span class="math inline">\(LR\)</span> statistic and set a threshold <span class="math inline">\(c &gt;0\)</span>. If the threshold is exceeded, than we conclude that there is a changepoint in the data and estimate this changepoint <span class="math inline">\(\tau\)</span> with :</p>
<p><span class="math display">\[
\hat \tau = \underset{\tau \in \{1, \dots, n-1 \}}{\text{argmax}} LR_\tau = \underset{\tau \in \{1, \dots, n-1 \}}{\text{argmax}} \frac{C_\tau^2}{\sigma^2}
\]</span></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>How to choose the threshold <span class="math inline">\(c\)</span>?</strong></p>
</div>
<div class="callout-content">
<p>Some theoretical results that ensure that the false positive rate tends to <span class="math inline">\(0\)</span> as <span class="math inline">\(n \to \infty\)</span> suggest that the threshold should be set to at least <span class="math inline">\(c = 2\log n\)</span>. However, this threshold can appear be to be quite conservative in some applications, and some papers suggest to use <span class="math inline">\(c = 2 \log \log n\)</span> instead.</p>
</div>
</div>
</div>
<p>The mean variation is simply estimated with <span class="math inline">\(\bar X_{1:\tau}-\bar X_{\tau+1:n}\)</span></p>
</section>
<section id="what-are-we-interested-in-1" class="slide level2">
<h2>What are we interested in ?</h2>
<h3 id="multiple-changepoints">Multiple changepoints</h3>
<ul>
<li>Unfortunately this framework becomes less efficient when there are several changepoints.
<ul>
<li>The presence of other changepoints affects the value of the CUSUM statistics, pushing it sometimes below the threshold even when there is an actual changepoint</li>
<li>This framework doesn’t help to estimate the number of changepoints</li>
</ul></li>
</ul>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>The penalised cost function</strong></p>
</div>
<div class="callout-content">
<p>To deal with the possibility of multiple changepoints, we define the notion of cost function <span class="math inline">\(f(\tau_1, \dots, \tau_q|X_1, \dots, X_n)\)</span>, which is a function that we aim to minimize in order to find the changepoints. One example of this function is simply the negative log-likelihood if we have a model for IID samples (e.g.&nbsp;Gaussian IID samples):</p>
<p><span class="math display">\[
f(\tau_1, \dots, \tau_q|X_1, \dots, X_n) = \frac{n}{2}\log\sigma^2 + \frac{\sum_{j=1}^{q+1}\sum_{i=\tau_{j-1}+1}^{\tau_j}(X_i- \bar X_{\tau_{j-1}+1:\tau_j})^2}{2\sigma^2}
\]</span></p>
<p>And aim to minimise the penalised cost:</p>
<p><span class="math display">\[
\underset{\tau_1, \dots, \tau_q}{\text{min}} ~f(\tau_1, \dots, \tau_q|X_1, \dots, X_n) + \beta(q)
\]</span></p>
<p>Where <span class="math inline">\(\beta(q)\)</span> is a penalisation that promotes solutions with a limited number of changepoints.</p>
</div>
</div>
</div>
</section>
<section id="what-are-we-interested-in-2" class="slide level2">
<h2>What are we interested in ?</h2>
<h3 id="multiple-changepoints-1">Multiple changepoints</h3>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example of penalisations</strong></p>
</div>
<div class="callout-content">
<ul>
<li>BIC : <span class="math inline">\(\beta(q) = q \log(n)\)</span></li>
<li>AIC : <span class="math inline">\(\beta(q) = 2q\)</span></li>
</ul>
<p>Each type of penalisation has its own pros/cons and theoretical results. For instance, under some regularity condition, the BIC penalisation ensures that the infered number of changepoints <span class="math inline">\(\hat q\)</span> converges to the true number of changepoints <span class="math inline">\(q^*\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="what-are-we-interested-in-3" class="slide level2">
<h2>What are we interested in ?</h2>
<h3 id="multiple-changepoints-2">Multiple changepoints</h3>
<p>Another idea estimates multiple changepoints is to use a recursive approach. Since we have an efficient method to detect one changepoint, why not use this method iteratively on a succession of intervals ?</p>
<h4 id="binary-segmentation-algorithm">Binary segmentation algorithm</h4>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>BS algorithm</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Find <span class="math inline">\(\hat \tau_1 = \underset{\tau \in \{1, \dots, n-1 \}}{\text{argmax}} C_\tau\)</span>
<ul>
<li>If <span class="math inline">\(C_{\hat \tau_1} &gt; c_n\)</span> then keep <span class="math inline">\(\hat \tau_1\)</span> in memory and run the first step again on the intervals <span class="math inline">\([1, \hat \tau_1]\)</span> and <span class="math inline">\([\hat \tau_1+1, n]\)</span>.</li>
<li>If <span class="math inline">\(C_{\hat \tau_1} \le c_n\)</span> then stop the algorithm and return the list of the kept changepoints.</li>
</ul></li>
</ul>
<p>Or</p>
<ul>
<li>Find <span class="math inline">\(\hat \tau_1 = \underset{\tau \in \{1, \dots, n-1 \}}{\text{argmax}} LR_\tau\)</span></li>
<li>Run again the first step again on the intervals <span class="math inline">\([1, \hat \tau_1]\)</span> and <span class="math inline">\([\hat \tau_1+1, n]\)</span>, until the length of the interval is less then 2.</li>
<li>Select the best changepoints collection using the penalised cost method.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="what-are-we-interested-in-4" class="slide level2">
<h2>What are we interested in ?</h2>
<h3 id="binary-segementation-algorithm">Binary segementation algorithm</h3>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Notes</strong></p>
</div>
<div class="callout-content">
<p>A good algorithm</p>
<ul>
<li>Easy to implement (recusrive algorithm)</li>
<li>Computationally efficient (complexity in <span class="math inline">\(\mathcal{O}(n\log n)\)</span>)</li>
</ul>
<p>But</p>
<ul>
<li>Relies on the ability of the CUSUM statistic to detect one changepoint among possibly several changepoints…</li>
<li>Need to select the right threshold <span class="math inline">\(c_n\)</span> in the first version of the algorithm…</li>
</ul>
</div>
</div>
</div>

<img data-src="Figures/multiple_changepoints.png" class="r-stretch quarto-figure-center"><p class="caption">Multiple changepoints with the CUSUM statistic</p></section>
<section id="what-are-we-interested-in-5" class="slide level2">
<h2>What are we interested in ?</h2>
<h3 id="multiple-changepoints-3">Multiple changepoints</h3>
<h4 id="wild-binary-segmentation-wbs-algorithm">Wild binary segmentation (WBS) algorithm</h4>
<p>To try to prevent the problem of ending up working in an interval that contains several changepoints and disturb the changepoint estimation, the Wild Binary Segmentation algorithm extend the BS algorithm to <span class="math inline">\(M\)</span> random sub-intervals <span class="math inline">\([s_m, e_m] \subset [1, n]\)</span> and only keeping the highest CUSUM statistic among the batch of CUSUM statistic calculated. This way, we hope that at least one of the random sub-interval only contains one true changepoint.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>BS algorithm</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Draw <span class="math inline">\(M\)</span> sub-intervals of <span class="math inline">\([1, n]\)</span> and let <span class="math inline">\(\mathcal{M}\)</span> be the set of the indices <span class="math inline">\(m\)</span> such that <span class="math inline">\([s_m, e_m] \subset [1, n]\)</span>.</li>
<li>Compute <span class="math inline">\(m_0, \hat \tau_1 = \underset{m\in\mathcal{M}, ~\tau \in [s_m, e_m]}{\text{argmax}} ~ C_{\tau}(X_{s_m:e_m})\)</span>
<ul>
<li>If <span class="math inline">\(LR_{\hat \tau_1} &gt; c_n\)</span> then keep <span class="math inline">\(\hat \tau_1\)</span> in memory and run the first step again on the intervals <span class="math inline">\([1, \hat \tau_1]\)</span> and <span class="math inline">\([\hat \tau_1+1, n]\)</span>.</li>
<li>If <span class="math inline">\(LR_{\hat \tau_1} \le c_n\)</span> then stop the algorithm and return the list of the kept changepoints.</li>
</ul></li>
</ul>
<p>Or</p>
<ul>
<li>Draw <span class="math inline">\(M\)</span> sub-intervals of <span class="math inline">\([1, n]\)</span> and let <span class="math inline">\(\mathcal{M}\)</span> be the set of the indices <span class="math inline">\(m\)</span> such that <span class="math inline">\([s_m, e_m] \subset [1, n]\)</span>.</li>
<li>Compute <span class="math inline">\(m_0, \hat \tau_1 = \underset{m\in\mathcal{M}, ~\tau \in [s_m, e_m]}{\text{argmax}} ~ C_{\tau}(X_{s_m:e_m})\)</span></li>
<li>Run again the first step again on the intervals <span class="math inline">\([1, \hat \tau_1]\)</span> and <span class="math inline">\([\hat \tau_1+1, n]\)</span>, until the length of the interval is less then 2.</li>
<li>Select the best changepoints collection using the penalised cost method.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="what-are-we-interested-in-6" class="slide level2">
<h2>What are we interested in ?</h2>
<h3 id="multiple-changepoints-4">Multiple changepoints</h3>
<h4 id="wild-binary-segmentation-wbs-algorithm-1">Wild binary segmentation (WBS) algorithm</h4>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Notes</strong></p>
</div>
<div class="callout-content">
<p>A good algorithm</p>
<ul>
<li>Solve the initial problem of perturbation of the CUSUM statistics when there are several changepoints</li>
<li>Computationally sill quite efficient</li>
</ul>
<p>But</p>
<ul>
<li>The computational cost increases with <span class="math inline">\(M\)</span>.</li>
<li>Need to select the right threshold <span class="math inline">\(c_n\)</span> in the first version of the algorithm…</li>
</ul>
</div>
</div>
</div>
</section>
<section id="what-are-we-interested-in-7" class="slide level2">
<h2>What are we interested in ?</h2>
<h3 id="multiple-changepoints-5">Multiple changepoints</h3>
<h4 id="optimal-partitionning">Optimal partitionning</h4>
<p>Let us come back to</p>
<p><span class="math display">\[
\underset{\tau_1, \dots, \tau_q}{\text{min}} ~f(\tau_1, \dots, \tau_q|X_1, \dots, X_n) + \beta(q)
\]</span></p>
<p>This minimisation problem greatly simplifies if we assume that the criteria <span class="math inline">\(f\)</span> can be broken down into a sum of costs over several segments:</p>
<p><span class="math display">\[
f(\tau_1, \dots, \tau_q|X_1, \dots, X_n) = \sum_{j=1}^{q+1} c_{\tau_{j-1}, \tau_j}(X_{1:n})
\]</span></p>
<p>Let us assume that <span class="math inline">\(\beta(q) = \lambda q\)</span> where <span class="math inline">\(\lambda\)</span> is a constant. We can therefore write the minimisation problem above as</p>
<p><span class="math display">\[
Q_{n, \lambda}(q; \tau_1, \dots, \tau_q) = \sum_{j=1}^{q+1}c_{\tau_{j-1}, \tau_j}(X_{1:n}) +q\lambda
\]</span></p>
</section>
<section id="what-are-we-interested-in-8" class="slide level2">
<h2>What are we interested in ?</h2>
<h3 id="multiple-changepoints-6">Multiple changepoints</h3>
<h4 id="optimal-partitionning-1">Optimal partitionning</h4>
<p>Now denote</p>
<p><span class="math display">\[
Q_{t, \lambda} = \underset{q; ~\tau_1 &lt; \dots &lt; \tau_q &lt;t}{\min} ~\sum_{j=1}^{q}c_{\tau_{j-1}, \tau_j}(X_{1:n}) + c_{\tau_{q}, t}(X_{1:n}) + q\lambda
\]</span> This can be interpreted as the <span class="bg" style="--col: #D78484">minimum segmentation cost</span> of the time series between times <span class="math inline">\(0\)</span> and <span class="math inline">\(t\)</span>. It can be be rewritten:</p>
<p><span class="math display">\[
Q_{t, \lambda} = \min \left\{ c_{0, t}(X_{1:n}), \underset{\tau = 1, \dots, t-1}{\min} Q_{\tau, \lambda} + c_{\tau, t}(X_{1:n}) + \lambda \right\}
\]</span> Which simplifies further if we set <span class="math inline">\(Q_{0, \lambda} = -\lambda\)</span> (this value is arbitrary as it represents the minimum segmenting cost of the series between <span class="math inline">\(0\)</span> and <span class="math inline">\(0\)</span>):</p>
<p><span class="math display">\[
Q_{t, \lambda} = \underset{\tau = 1, \dots, t-1}{\min} Q_{\tau, \lambda} + c_{\tau, t}(X_{1:n}) + \lambda
\]</span></p>
</section>
<section id="what-are-we-interested-in-9" class="slide level2">
<h2>What are we interested in ?</h2>
<h3 id="multiple-changepoints-7">Multiple changepoints</h3>
<h4 id="optimal-partitionning-2">Optimal partitionning</h4>
<p>This last expression has a recursive structure that one can exploit to solve this minimisation problem and estimate the changepoints <span class="math inline">\((\hat \tau_j)_j\)</span> and their number <span class="math inline">\(\hat q\)</span>:</p>
<p><span class="math display">\[
\hat \tau_1 = \underset{\tau = 0, \dots, n-1}{\text{argmin}} Q_{\tau, \lambda} + c_{\tau, n}(X_{1:n}) + \lambda
\]</span> And then</p>
<p><span class="math display">\[
\hat \tau_{j+1} = \underset{\tau = 0, \dots,\hat \tau_j-1}{\text{argmin}} Q_{\tau_, \lambda} + c_{\tau, \hat \tau_j}(X_{1:n}) + \lambda
\]</span></p>
<p>We recursively computes the <span class="math inline">\((\hat \tau_j)_j\)</span> until we fine <span class="math inline">\(\hat \tau = 0\)</span>.</p>
</section>
<section id="what-are-we-interested-in-10" class="slide level2">
<h2>What are we interested in ?</h2>
<h3 id="multiple-changepoints-8">Multiple changepoints</h3>
<h4 id="pruned-exact-linear-time-pelt-algorithm">Pruned exact linear time (PELT) algorithm</h4>
<p>The problem of the optimal partitioning is its computational cost: <span class="math inline">\(\mathcal{O}(n^2)\)</span> (which can become prohibitive in some applications). The PELT algorithm has been introduced to reduce the computational cost of optimal partitioning by adding a <em>pruning</em> rule that prunes parts of the search space that are deemed to have a higher segmentation cost.</p>
<p>Indeed if at some point <span class="math inline">\(\tau\)</span> we have:</p>
<p><span class="math display">\[
Q_{\tau, \lambda} + c_{\tau+1:t}(X_{1:n}) + a &gt; Q_t, \quad \text{for some } a&gt;0
\]</span> Then <span class="math inline">\(\tau\)</span> will never be an acceptable changepoint, and can thus be eliminated from the search space.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Complexity of the PELT algorithm</strong></p>
</div>
<div class="callout-content">
<p>It has been proven that if the number of changepoint linearly increases with the number of observations (constant changepoint rate), then the complexity of the PELT algorithm becomes <span class="math inline">\(\mathcal{O}(n)\)</span>! If this assumption doesn’t hold, then the algorithm keeps a quadratic complexity (<span class="citation" data-cites="killick_optimal_2012">Killick, Fearnhead, and Eckley (<a href="#/references" role="doc-biblioref" onclick="">2012</a>)</span>).</p>
</div>
</div>
</div>
</section>
<section id="bayesian-approach" class="slide level2">
<h2>Bayesian approach</h2>
<h3 id="bayesian-online-changepoint-detection">Bayesian online changepoint detection</h3>
<p>This method, based on <span class="citation" data-cites="fearnhead_-line_2007">Fearnhead and Liu (<a href="#/references" role="doc-biblioref" onclick="">2007</a>)</span> and <span class="citation" data-cites="adams_bayesian_2007">Adams and MacKay (<a href="#/references" role="doc-biblioref" onclick="">2007</a>)</span>, adopts a Bayesian approach to compute the posterior probability distribution of the “run length” <span class="math inline">\(r_t\)</span> (i.e.&nbsp;the time after the last change point):</p>
<p><span class="math display">\[
r_t=\begin{cases}
            0, &amp; \text{if $t$ is a changepoint}\\
            r_{t-1} + 1, &amp; \text{otherwise}
         \end{cases}
\]</span></p>
<p>The idea is to assign a prior to the “hazard rate” (i.e.&nbsp;the frequency at which the changepoints occur) and use the exponential family posterior predictive closed formula to compute the posterior probability distribution of <span class="math inline">\(r_t\)</span> at every <span class="math inline">\(t\)</span>:</p>
<p><span class="math display">\[
p(r_t | X_{1:t}) = \frac{p(r_t, X_{1:t})}{\sum_{r_{t'}} p(r_{t'}, X_{1:t})}
\]</span></p>
</section>
<section id="bayesian-approach-1" class="slide level2">
<h2>Bayesian approach</h2>
<h3 id="bayesian-online-changepoint-detection-1">Bayesian online changepoint detection</h3>
<div class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Presentation_files/figure-revealjs/cell-3-output-1.png" width="811" height="505"></p>
<figcaption>Example of mean changepoint detection with the BOCD algorithm. The bottom plot represent the posterior probability distribution of <span class="math inline">\(r_t\)</span>.</figcaption>
</figure>
</div>
</div>
</div>
</section></section>
<section>
<section id="applications-1" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>Applications</h1>

</section>
<section id="canonical-datasets" class="slide level2">
<h2>Canonical datasets</h2>
<h3 id="well-log">Well log</h3>
<div class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Presentation_files/figure-revealjs/cell-4-output-1.png" width="824" height="411"></p>
<figcaption>Material response vs depth during an oil well drilling. This type of data is used to analyse the soil and determine what is the best depth and orientation for the forage.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="canonical-datasets-1" class="slide level2">
<h2>Canonical datasets</h2>
<h3 id="dow-jones-industrial-average">Dow Jones Industrial Average</h3>
<div class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Presentation_files/figure-revealjs/cell-5-output-1.png" width="813" height="402"></p>
<figcaption>Daily returns of the Dow Jones Industrial Average index between 1970 and 2000. This can be one building block for market risk monitoring.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="application-in-risk-monitoring-in-finance" class="slide level2">
<h2>Application in risk monitoring in Finance</h2>
<h3 id="dataset">Dataset</h3>
<p>To monitor financial markets and potentially take action to protect financial stability, trading venues monitor the volatility of the different stock index, to do so, they need some sort of <em>online</em> changepoint detection.</p>
<div class="cell" data-execution_count="5">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Presentation_files/figure-revealjs/cell-6-output-1.png" width="792" height="411"></p>
<figcaption>Example of variance changepoint dataset. Between the 2 changepoints, the variance is 3 times higher than the rest of the series.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="application-in-risk-monitoring-in-finance-1" class="slide level2">
<h2>Application in risk monitoring in Finance</h2>
<h3 id="changepoint-algorithm">Changepoint algorithm</h3>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">def</span> BOCD_var(signal, alpha0, beta0, hazard_prob, mu <span class="op">=</span> <span class="dv">0</span>):</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>    <span class="co"># Initialisation</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>    T <span class="op">=</span> <span class="bu">len</span>(signal)</span>
<span id="cb1-5"><a href="#cb1-5"></a>    log_R <span class="op">=</span> <span class="op">-</span>np.inf <span class="op">*</span> np.ones((T<span class="op">+</span><span class="dv">1</span>, T<span class="op">+</span><span class="dv">1</span>)) <span class="co"># Run length posterior log-probability matrix</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>    log_R[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span> <span class="co"># At time 0, the posterior proability is initialised to 1 at R = 0</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a>    posterior_precision <span class="op">=</span> np.nan <span class="op">*</span> np.empty(T) <span class="co"># Mean of the posterior distribution of the precision</span></span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a>    log_message <span class="op">=</span> np.array([<span class="dv">0</span>]) <span class="co"># message initialised at 1</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>    log_H <span class="op">=</span> np.log(hazard_prob) <span class="co"># Constant prior on changepoint probability.</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>    log_1_minus_H <span class="op">=</span> np.log(<span class="dv">1</span><span class="op">-</span>hazard_prob)</span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a>    <span class="co"># Prior's parameters for the previous data point</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>    prior_shape <span class="op">=</span> np.array([alpha0])</span>
<span id="cb1-17"><a href="#cb1-17"></a>    prior_rate <span class="op">=</span> np.array([beta0]) </span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a></span>
<span id="cb1-20"><a href="#cb1-20"></a>    <span class="co"># Online posterior distribution of the run length update:</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, T<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb1-22"><a href="#cb1-22"></a>        x <span class="op">=</span> signal[t<span class="op">-</span><span class="dv">1</span>] <span class="co"># Reading the new data point</span></span>
<span id="cb1-23"><a href="#cb1-23"></a></span>
<span id="cb1-24"><a href="#cb1-24"></a>        <span class="co"># Posterior mean for the precision</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>        posterior_precision[t<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> prior_shape[t<span class="op">-</span><span class="dv">1</span>]<span class="op">/</span>prior_rate[t<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb1-26"><a href="#cb1-26"></a></span>
<span id="cb1-27"><a href="#cb1-27"></a>        <span class="co"># Posterior predictive probabilities for each run length</span></span>
<span id="cb1-28"><a href="#cb1-28"></a>        log_pis <span class="op">=</span> student.logpdf(x, df <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>prior_shape[:t], loc <span class="op">=</span> mu, scale <span class="op">=</span> prior_rate[:t]<span class="op">/</span>prior_shape[:t])</span>
<span id="cb1-29"><a href="#cb1-29"></a>        </span>
<span id="cb1-30"><a href="#cb1-30"></a>        <span class="co"># Growth probability</span></span>
<span id="cb1-31"><a href="#cb1-31"></a>        log_growth_probs <span class="op">=</span> log_pis <span class="op">+</span> log_message <span class="op">+</span> log_1_minus_H</span>
<span id="cb1-32"><a href="#cb1-32"></a></span>
<span id="cb1-33"><a href="#cb1-33"></a>        <span class="co"># Changepoint probability</span></span>
<span id="cb1-34"><a href="#cb1-34"></a>        log_cp_prob <span class="op">=</span> logsumexp(log_pis <span class="op">+</span> log_message <span class="op">+</span> log_H)</span>
<span id="cb1-35"><a href="#cb1-35"></a></span>
<span id="cb1-36"><a href="#cb1-36"></a>        <span class="co"># Computing the evidence</span></span>
<span id="cb1-37"><a href="#cb1-37"></a>        new_log_joint  <span class="op">=</span> np.append(log_cp_prob, log_growth_probs)</span>
<span id="cb1-38"><a href="#cb1-38"></a></span>
<span id="cb1-39"><a href="#cb1-39"></a>        <span class="co"># Updating the run length distribution at time t</span></span>
<span id="cb1-40"><a href="#cb1-40"></a>        log_R[t, :t<span class="op">+</span><span class="dv">1</span>]  <span class="op">=</span> new_log_joint</span>
<span id="cb1-41"><a href="#cb1-41"></a>        log_R[t, :t<span class="op">+</span><span class="dv">1</span>] <span class="op">-=</span> logsumexp(new_log_joint)</span>
<span id="cb1-42"><a href="#cb1-42"></a></span>
<span id="cb1-43"><a href="#cb1-43"></a>        <span class="co"># Updating the prior parameters for the next step</span></span>
<span id="cb1-44"><a href="#cb1-44"></a></span>
<span id="cb1-45"><a href="#cb1-45"></a>        prior_shape <span class="op">=</span> np.append([alpha0], prior_shape <span class="op">+</span> <span class="fl">0.5</span>)</span>
<span id="cb1-46"><a href="#cb1-46"></a>        prior_rate <span class="op">=</span> np.append([beta0], prior_rate <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> (x <span class="op">-</span> mu)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb1-47"><a href="#cb1-47"></a>        </span>
<span id="cb1-48"><a href="#cb1-48"></a>        <span class="co"># Pass message</span></span>
<span id="cb1-49"><a href="#cb1-49"></a>        log_message <span class="op">=</span> new_log_joint</span>
<span id="cb1-50"><a href="#cb1-50"></a></span>
<span id="cb1-51"><a href="#cb1-51"></a>    <span class="cf">return</span> {<span class="st">"post_R"</span>: np.exp(log_R), <span class="st">"post_precision"</span>: posterior_precision}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="application-in-risk-monitoring-in-finance-2" class="slide level2">
<h2>Application in risk monitoring in Finance</h2>
<h3 id="results">Results</h3>
<div class="cell" data-execution_count="7">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Presentation_files/figure-revealjs/cell-8-output-1.png" width="967" height="542"></p>
<figcaption>Result of the BOCD algorithm on the variance changepoint dataset.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="application-in-risk-monitoring-in-finance-3" class="slide level2">
<h2>Application in risk monitoring in Finance</h2>
<h3 id="results-1">Results</h3>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Remarks</strong></p>
</div>
<div class="callout-content">
<p>Note that the inferred variance seem to do great at the beginning, but then lacks reactivity. This is beacause of the online nature of the BOCD algorithm: at every time-step it keeps memory of what happened in the past, and the longer the past is, the stronger the memory gets.</p>
<p>A starting point to try to prevent this problem is could be to restart the algorithm all over again when a changepoint is detected. See <span class="citation" data-cites="restarted_alami_2020">Alami, Maillard, and Feraud (<a href="#/references" role="doc-biblioref" onclick="">2020</a>)</span> for a complete application on Bernoulli random variables.</p>
</div>
</div>
</div>
</section>
<section id="other-possible-examples-of-applications" class="slide level2">
<h2>Other possible examples of applications</h2>
<h3 id="retrospective-analysis-of-gdp-growth">Retrospective analysis of GDP growth</h3>
<p>To analyse the effects of economic policies or the economic cycles, one can apply an <em>offline</em> changepoint analysis with a PELT algorithm to infer the number and the location of the changepoints, which can indicate a change in the economic cycle.</p>
<div class="cell" data-execution_count="8">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Presentation_files/figure-revealjs/cell-9-output-1.png" width="964" height="376"></p>
<figcaption>Offline changepoint analysis of the US GPD growth between 1960 and 2018. The PELT algorithm was used to infer the changepoints.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="other-possible-examples-of-applications-1" class="slide level2">
<h2>Other possible examples of applications</h2>
<h3 id="retrospective-analysis-of-gdp-growth-1">Retrospective analysis of GDP growth</h3>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb2" data-code-line-numbers="|1|10-11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> ruptures <span class="im">as</span> rpt</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a>data <span class="op">=</span> pd.read_csv(<span class="st">"../Datasets/gdp.csv"</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a>country_gdp <span class="op">=</span> data.loc[data[<span class="st">"Country Code"</span>] <span class="op">==</span> <span class="st">"USA"</span>].melt(id_vars<span class="op">=</span><span class="st">"Country Name"</span>, value_vars <span class="op">=</span> [<span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1960</span>, <span class="dv">2019</span>)], var_name <span class="op">=</span> <span class="st">"Year"</span>, value_name<span class="op">=</span><span class="st">"GDP"</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a>country_gdp[<span class="st">"Growth"</span>] <span class="op">=</span> country_gdp[<span class="st">"GDP"</span>].pct_change()</span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a>growth_data <span class="op">=</span> np.array(country_gdp[<span class="st">'Growth'</span>])[<span class="dv">1</span>:]<span class="op">*</span><span class="dv">100</span></span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a>algo <span class="op">=</span> rpt.Pelt(model <span class="op">=</span> <span class="st">"l1"</span>, min_size <span class="op">=</span> <span class="dv">2</span>).fit(growth_data)</span>
<span id="cb2-11"><a href="#cb2-11"></a>changepoints <span class="op">=</span> algo.predict(pen <span class="op">=</span> np.log(<span class="bu">len</span>(growth_data)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="useful-libraries-package-and-repository" class="slide level2">
<h2>Useful libraries, package and repository</h2>
<h4 id="in-r">In R</h4>
<ul>
<li><code>mcp</code></li>
<li><code>segmented</code></li>
</ul>
<h4 id="in-python">In Python</h4>
<ul>
<li><code>ruptures</code></li>
<li><code>changepoynt</code></li>
</ul>
<h4 id="useful-github-repositories">Useful GitHub repositories</h4>
<p><a href="https://github.com/gwgundersen/bocd">https://github.com/gwgundersen/bocd</a> <a href="https://github.com/alan-turing-institute/TCPD/tree/master">https://github.com/alan-turing-institute/TCPD/tree/master</a></p>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<h3 id="code-and-presentation">Code and presentation</h3>
<p><a href="https://github.com/EtienneCap/ChangepointDetection">GitHub repository</a></p>
<h3 id="textbooks-and-articles">Textbooks and articles</h3>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-adams_bayesian_2007" class="csl-entry" role="listitem">
Adams, Ryan Prescott, and David J. C. MacKay. 2007. <span>“Bayesian <span>Online</span> <span>Changepoint</span> <span>Detection</span>.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.0710.3742">https://doi.org/10.48550/arXiv.0710.3742</a>.
</div>
<div id="ref-restarted_alami_2020" class="csl-entry" role="listitem">
Alami, Reda, Odalric Maillard, and Raphael Feraud. 2020. <span>“Restarted <span>B</span>ayesian Online Change-Point Detector Achieves Optimal Detection Delay.”</span> In <em>Proceedings of the 37th International Conference on Machine Learning</em>, edited by Hal Daume III and Aarti Singh, 119:211–21. Proceedings of Machine Learning Research. PMLR. <a href="https://proceedings.mlr.press/v119/alami20a.html">https://proceedings.mlr.press/v119/alami20a.html</a>.
</div>
<div id="ref-noauthor_bayesian_nodate" class="csl-entry" role="listitem">
<span>“Bayesian <span>Online</span> <span>Changepoint</span> <span>Detection</span>.”</span> n.d. Accessed June 6, 2024. <a href="https://gregorygundersen.com/blog/2019/08/13/bocd/#adams2007bayesian">https://gregorygundersen.com/blog/2019/08/13/bocd/#adams2007bayesian</a>.
</div>
<div id="ref-fearnhead_detecting_2022" class="csl-entry" role="listitem">
Fearnhead, Paul, and Piotr Fryzlewicz. 2022. <span>“Detecting <span>A</span> <span>Single</span> <span>Change</span>-Point.”</span> arXiv. <a href="http://arxiv.org/abs/2210.07066">http://arxiv.org/abs/2210.07066</a>.
</div>
<div id="ref-fearnhead_multiple_2024" class="csl-entry" role="listitem">
———. 2024. <span>“The <span>Multiple</span> <span>Change</span>-in-<span>Gaussian</span>-<span>Mean</span> <span>Problem</span>.”</span> arXiv. <a href="http://arxiv.org/abs/2405.06796">http://arxiv.org/abs/2405.06796</a>.
</div>
<div id="ref-fearnhead_-line_2007" class="csl-entry" role="listitem">
Fearnhead, Paul, and Zhen Liu. 2007. <span>“On-Line Inference for Multiple Changepoint Problems.”</span> <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 69 (4): 589–605. <a href="https://doi.org/10.1111/j.1467-9868.2007.00601.x">https://doi.org/10.1111/j.1467-9868.2007.00601.x</a>.
</div>
<div id="ref-feasel_finding_2022" class="csl-entry" role="listitem">
Feasel, Kevin. 2022. <em>Finding <span>Ghosts</span> in <span>Your</span> <span>Data</span>: <span>Anomaly</span> <span>Detection</span> <span>Techniques</span> with <span>Examples</span> in <span>Python</span></em>. Berkeley, CA: Apress. <a href="https://doi.org/10.1007/978-1-4842-8870-2">https://doi.org/10.1007/978-1-4842-8870-2</a>.
</div>
<div id="ref-killick_optimal_2012" class="csl-entry" role="listitem">
Killick, R., P. Fearnhead, and I. A. Eckley. 2012. <span>“Optimal Detection of Changepoints with a Linear Computational Cost.”</span> <em>Journal of the American Statistical Association</em> 107 (500): 1590–98. <a href="https://doi.org/10.1080/01621459.2012.737745">https://doi.org/10.1080/01621459.2012.737745</a>.
</div>
<div id="ref-oudre_machine_2023" class="csl-entry" role="listitem">
Oudre, Laurent. 2023. <span>“Machine <span>Learning</span> for <span>Time</span> <span>Series</span> - <span>Lecture</span> 5: <span>Change</span>-Point and <span>Anomaly</span> <span>Detection</span>.”</span> <a href="http://www.laurentoudre.fr/ast/">http://www.laurentoudre.fr/ast/</a>.
</div>
</div>
<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Presentation_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/reveal-text-resizer/revealjs-text-resizer.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Presentation_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Presentation_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealTextResizer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>